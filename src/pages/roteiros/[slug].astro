---
import BaseLayout from "../../layouts/BaseLayout.astro";
import roteiros from "../../data/roteiros";
import { CATEGORIAS } from "../../data/categorias";

/* üîë OBRIGAT√ìRIO PARA ROTAS DIN√ÇMICAS */
export async function getStaticPaths() {
  return roteiros.map((roteiro) => ({
    params: { slug: roteiro.slug },
  }));
}

const { slug } = Astro.params;
const roteiro = roteiros.find(r => r.slug === slug);
const categoria = CATEGORIAS.find(c => c.id === roteiro?.categoria);
const iconPath = categoria?.icon;
if (!roteiro) {
  throw new Error(`Roteiro n√£o encontrado: ${slug}`);
}
---

{roteiro ? (
  <BaseLayout title={`${roteiro.titulo} | Estradas que Contam Hist√≥rias`}>

    <!-- HERO -->
    <section class="relative h-[60vh] bg-neutral-200/80 flex items-center justify-start">
      <img
        src={roteiro.imagem}
        alt={roteiro.titulo}
        class="absolute inset-0 w-full h-full object-contain z-1"
        loading="lazy"
      />

      <div class="absolute inset-0 bg-linear-to-t from-black/80 via-black/30 to-transparent"></div>

      <div class="relative bg-neutral-800/80 z-10 px-6 pt-6 pb-6 max-w-3xl items-start">
        <span class="flex items-center gap-2 text-sm uppercase tracking-wider text-neutral-300 mb-3">
          {iconPath && (
            <img src={iconPath} alt={categoria?.label} width="32" height="32" class="inline-block align-middle" style="filter: invert(80%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(90%) contrast(90%);" />
          )}
          {categoria?.label}
        </span>
        
        <h1 class="text-4xl md:text-4xl font-serif text-white mb-4 text-center">
          {roteiro.titulo}
        </h1>

        <p class="text-lg text-neutral-300 max-w-2xl text-center">
          {roteiro.subtitulo}
        </p>
      </div>
    </section>

    <!-- INFO R√ÅPIDA -->
    <section class="px-6 md:px-20 py-6 bg-neutral-950 border-t border-neutral-800">
      <ul class="grid grid-cols-2 md:grid-cols-5 gap-4 text-center max-w-9xl">
        <li>
          <span class="label">Regi√£o</span><br />
          <span class="value">{roteiro.regiao}</span>
        </li>
        <li>
          <span class="label">Dist√¢ncia</span><br />
          <span class="value">{roteiro.distancia}</span>
        </li>
        <li>
          <span class="label">Dura√ß√£o</span><br />
          <span class="value">{roteiro.duracao}</span>
        </li>
        <li>
          <span class="label">N√≠vel</span><br />
          <span class="value">{roteiro.nivel}</span>
        </li>
        <li>
          <span class="label">Formato</span><br />
          <span class="value">{roteiro.tipo}</span>
        </li>
      </ul>
    </section>

    <!-- HIST√ìRIA -->
    <section class="px-6 md:px-20 py-24 max-w-3xl">
      <h2 class="section-title">A hist√≥ria da estrada</h2>
      <p class="section-text whitespace-pre-line">
        {roteiro.historia}
      </p>
    </section>

    <!-- O CAMINHO -->
    <section class="px-6 md:px-20 py-20 bg-neutral-950 border-t border-neutral-800">
      <h2 class="section-title mb-8">O caminho</h2>

      <ol class="space-y-4 max-w-xl">
        {roteiro.caminho.map((ponto, index) => (
          <li class="flex gap-4 items-start">
            <span class="text-neutral-400 font-mono">
              {index + 1}
            </span>
            <span class="text-neutral-300">
              {ponto}
            </span>
          </li>
        ))}
      </ol>
    </section>

    <!-- EXPERI√äNCIA -->
    <section class="px-6 md:px-20 py-20 max-w-4xl">
      <h2 class="section-title mb-8">O que esperar da viagem</h2>

      <ul class="grid md:grid-cols-2 gap-6">
        {roteiro.experiencia.map(item => (
          <li class="border border-neutral-700 rounded-xl p-6 text-neutral-300">
            {item}
          </li>
        ))}
      </ul>
    </section>

    <!-- CTA -->
    <section class="px-6 md:px-20 py-24 bg-neutral-950 border-t border-neutral-800 text-center">
      <h2 class="text-3xl font-serif mb-6">
        Pronto para viver essa estrada?
      </h2>

      <p class="text-neutral-400 mb-8">
        Esse roteiro pode ser adaptado ao seu ritmo, estilo e moto.
      </p>

      <a
        href="/contato"
        class="inline-block px-8 py-4 rounded-full bg-white text-neutral-900 font-medium hover:scale-105 transition"
      >
        Fale sobre essa viagem
      </a>
    </section>

  </BaseLayout>
) : (
  <BaseLayout title="Roteiro n√£o encontrado | Estradas que Contam Hist√≥rias">
    <section class="px-6 md:px-20 py-24 text-center">
      <h1 class="text-4xl md:text-5xl font-serif mb-4">
        Roteiro n√£o encontrado
      </h1>
      <p class="text-lg text-neutral-300">
        O roteiro solicitado n√£o foi encontrado. Por favor, verifique o endere√ßo ou escolha outro roteiro.
      </p>
    </section>
  </BaseLayout>
)}